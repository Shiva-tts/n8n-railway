"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getLabels = getLabels;
exports.getThreadMessages = getThreadMessages;
exports.getGmailAliases = getGmailAliases;
const GenericFunctions_1 = require("../GenericFunctions");
async function getLabels() {
    const returnData = [];
    const labels = await GenericFunctions_1.googleApiRequestAllItems.call(this, 'labels', 'GET', '/gmail/v1/users/me/labels');
    for (const label of labels) {
        returnData.push({
            name: label.name,
            value: label.id,
        });
    }
    return returnData.sort((a, b) => {
        if (a.name < b.name) {
            return -1;
        }
        if (a.name > b.name) {
            return 1;
        }
        return 0;
    });
}
async function getThreadMessages() {
    const returnData = [];
    const id = this.getNodeParameter('threadId', 0);
    const { messages } = await GenericFunctions_1.googleApiRequest.call(this, 'GET', `/gmail/v1/users/me/threads/${id}`, {}, { format: 'minimal' });
    for (const message of messages || []) {
        returnData.push({
            name: message.snippet,
            value: message.id,
        });
    }
    return returnData;
}
async function getGmailAliases() {
    const returnData = [];
    const { sendAs } = await GenericFunctions_1.googleApiRequest.call(this, 'GET', '/gmail/v1/users/me/settings/sendAs');
    for (const alias of sendAs || []) {
        const displayName = alias.isDefault ? `${alias.sendAsEmail} (Default)` : alias.sendAsEmail;
        returnData.push({
            name: displayName,
            value: alias.sendAsEmail,
        });
    }
    return returnData;
}
//# sourceMappingURL=loadOptions.js.map